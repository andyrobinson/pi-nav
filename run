#!/usr/bin/env python
import sys
import subprocess
from src import *

COMMANDS = ['test','track','integration']
DEFAULT_COMMAND = 'test'

if __name__ == '__main__':
    command =  sys.argv[1] if len(sys.argv) > 1 else DEFAULT_COMMAND

    if len(sys.argv) > 2 or command not in COMMANDS:
        sys.exit('Usage: %s [%s]' % (sys.argv[0],'|'.join(COMMANDS)))

    if command == 'test':
        subprocess.call([sys.executable, '-m', 'unittest', 'discover', '-s','test'])

    if command == 'integration':
        subprocess.call([sys.executable, '-m', 'unittest', 'discover', '-s','integration_test'])

    if command == 'track':
        gps = gps_reader.GpsReader()
        gps.start()
        main.App(console_logger.Logger(),gps,timed_callback.TimedCallback()).track(10)
